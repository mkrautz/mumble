#include <openssl/dh.h>
#include <openssl/bn.h>

int main(int argc, char *argv[]) {

struct standard_parameters {
  BIGNUM p, q, g;
};

static const BN_ULONG ffdhe2048_p[] = {
	TOBN(0xFFFFFFFF),
	TOBN(0xFFFFFFFF),
	TOBN(0xADF85458),
	TOBN(0xA2BB4A9A),
	TOBN(0xAFDC5620),
	TOBN(0x273D3CF1),
	TOBN(0xD8B9C583),
	TOBN(0xCE2D3695),
	TOBN(0xA9E13641),
	TOBN(0x146433FB),
	TOBN(0xCC939DCE),
	TOBN(0x249B3EF9),
	TOBN(0x7D2FE363),
	TOBN(0x630C75D8),
	TOBN(0xF681B202),
	TOBN(0xAEC4617A),
	TOBN(0xD3DF1ED5),
	TOBN(0xD5FD6561),
	TOBN(0x2433F51F),
	TOBN(0x5F066ED0),
	TOBN(0x85636555),
	TOBN(0x3DED1AF3),
	TOBN(0xB557135E),
	TOBN(0x7F57C935),
	TOBN(0x984F0C70),
	TOBN(0xE0E68B77),
	TOBN(0xE2A689DA),
	TOBN(0xF3EFE872),
	TOBN(0x1DF158A1),
	TOBN(0x36ADE735),
	TOBN(0x30ACCA4F),
	TOBN(0x483A797A),
	TOBN(0xBC0AB182),
	TOBN(0xB324FB61),
	TOBN(0xD108A94B),
	TOBN(0xB2C8E3FB),
	TOBN(0xB96ADAB7),
	TOBN(0x60D7F468),
	TOBN(0x1D4F42A3),
	TOBN(0xDE394DF4),
	TOBN(0xAE56EDE7),
	TOBN(0x6372BB19),
	TOBN(0x0B07A7C8),
	TOBN(0xEE0A6D70),
	TOBN(0x9E02FCE1),
	TOBN(0xCDF7E2EC),
	TOBN(0xC03404CD),
	TOBN(0x28342F61),
	TOBN(0x9172FE9C),
	TOBN(0xE98583FF),
	TOBN(0x8E4F1232),
	TOBN(0xEEF28183),
	TOBN(0xC3FE3B1B),
	TOBN(0x4C6FAD73),
	TOBN(0x3BB5FCBC),
	TOBN(0x2EC22005),
	TOBN(0xC58EF183),
	TOBN(0x7D1683B2),
	TOBN(0xC6F34A26),
	TOBN(0xC1B2EFFA),
	TOBN(0x886B4238),
	TOBN(0x61285C97),
	TOBN(0xFFFFFFFF),
	TOBN(0xFFFFFFFF)
};

static const BN_ULONG ffdhe2048_q[] = {
	TOBN(0x7FFFFFFF),
	TOBN(0xFFFFFFFF),
	TOBN(0xD6FC2A2C),
	TOBN(0x515DA54D),
	TOBN(0x57EE2B10),
	TOBN(0x139E9E78),
	TOBN(0xEC5CE2C1),
	TOBN(0xE7169B4A),
	TOBN(0xD4F09B20),
	TOBN(0x8A3219FD),
	TOBN(0xE649CEE7),
	TOBN(0x124D9F7C),
	TOBN(0xBE97F1B1),
	TOBN(0xB1863AEC),
	TOBN(0x7B40D901),
	TOBN(0x576230BD),
	TOBN(0x69EF8F6A),
	TOBN(0xEAFEB2B0),
	TOBN(0x9219FA8F),
	TOBN(0xAF833768),
	TOBN(0x42B1B2AA),
	TOBN(0x9EF68D79),
	TOBN(0xDAAB89AF),
	TOBN(0x3FABE49A),
	TOBN(0xCC278638),
	TOBN(0x707345BB),
	TOBN(0xF15344ED),
	TOBN(0x79F7F439),
	TOBN(0x0EF8AC50),
	TOBN(0x9B56F39A),
	TOBN(0x98566527),
	TOBN(0xA41D3CBD),
	TOBN(0x5E0558C1),
	TOBN(0x59927DB0),
	TOBN(0xE88454A5),
	TOBN(0xD96471FD),
	TOBN(0xDCB56D5B),
	TOBN(0xB06BFA34),
	TOBN(0x0EA7A151),
	TOBN(0xEF1CA6FA),
	TOBN(0x572B76F3),
	TOBN(0xB1B95D8C),
	TOBN(0x8583D3E4),
	TOBN(0x770536B8),
	TOBN(0x4F017E70),
	TOBN(0xE6FBF176),
	TOBN(0x601A0266),
	TOBN(0x941A17B0),
	TOBN(0xC8B97F4E),
	TOBN(0x74C2C1FF),
	TOBN(0xC7278919),
	TOBN(0x777940C1),
	TOBN(0xE1FF1D8D),
	TOBN(0xA637D6B9),
	TOBN(0x9DDAFE5E),
	TOBN(0x17611002),
	TOBN(0xE2C778C1),
	TOBN(0xBE8B41D9),
	TOBN(0x6379A513),
	TOBN(0x60D977FD),
	TOBN(0x4435A11C),
	TOBN(0x30942E4B),
	TOBN(0xFFFFFFFF),
	TOBN(0xFFFFFFFF)
};

	DH *dh = DH_new();
	if (!dh) {
		exit(2);
	}
	
	BIGNUM *g = BN_new();
	BN_set_word(g, 2);

	BIGNUM g = {
		STATIC_BIGNUM(ffdhe2048_p)
	}



	dh->p = BN_dup(&ffdhe2048_p);
	dh->q = BN_dup(&ffdhe2048_q);
	dh->g = BN_dup(&params->g);
	if (!dh->p || !dh->q || !dh->g) {
    	DH_free(dh);
    	exit(2);
    }

    printf("dh = %p\n", dh);
	exit(0);
}